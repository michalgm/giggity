(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5492:function(e,t,a){e.exports=a(5745)},5497:function(e,t,a){},5654:function(e,t){},5684:function(e,t,a){},5707:function(e,t,a){},5719:function(e,t,a){},5737:function(e,t,a){},5738:function(e,t,a){},5739:function(e,t,a){},5741:function(e,t,a){},5745:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(34),c=a.n(i),o=(a(5497),a(235)),l=a.n(o),s=a(234),u=a.n(s),m=a(20),p=a(21),d=a(24),h=a(22),b=a(23),f=a(49),v=a(5749),g=a(5750),y=a(50),E=a(16),j=a(32),O=a(25),w=a(108),k={gigsList:[],currentGig:{_id:""},currentUser:{},userAvailability:{},currentGigAvailability:{},users:[],errors:[],authenticated:!1,drawerOpen:!1,projects:[],currentProject:{}},_={loadGigs:function(e){return{type:"LOAD_GIGS",payload:e.map(function(e){return Object(E.a)({},e)})}},gigUpdated:function(e){return{type:"GIG_UPDATED",payload:e}},loadGig:function(e){return{type:"LOAD_GIG",payload:Object(E.a)({},e)}},loadUsers:function(e){return{type:"LOAD_USERS",payload:e.map(function(e){return e.user&&e.user.name&&(delete e.user._id,Object.assign(e,e.user),delete e.user),e})}},loadProjects:function(e){return{type:"LOAD_PROJECTS",payload:e}},setUser:function(e){return{type:"SET_USER",payload:e}},setProject:function(e){return{type:"SET_PROJECT",payload:e}},loadGigAvailability:function(e){return{type:"LOAD_GIG_AVAILABILITY",payload:e}},availabilityUpdated:function(e){return{type:"UPDATE_AVAILABILITY",payload:e}},loadUserAvailability:function(e){return{type:"LOAD_USER_AVAILABILITY",payload:e}},addError:function(e){return{type:"ADD_ERROR",payload:e}},removeError:function(e){return{type:"REMOVE_ERROR",payload:e}},updateDrawer:function(e){return{type:"UPDATE_DRAWER",payload:e}},setAuth:function(e){return{type:"SET_AUTH",payload:e}},resetApp:function(){return{type:"RESET_APP"}}},S=Object(w.b)(function(e,t){return"RESET_APP"===t.type&&(e=void 0),function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:k,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOAD_USERS":return Object(E.a)({},e,{users:t.payload});case"LOAD_PROJECTS":return Object(E.a)({},e,{projects:t.payload});case"SET_PROJECT":return Object(E.a)({},e,{currentProject:t.payload});case"SET_USER":return Object(E.a)({},e,{currentUser:t.payload});case"LOAD_GIGS":return Object(E.a)({},e,{gigsList:t.payload});case"LOAD_GIG":return Object(E.a)({},e,{currentGig:t.payload});case"LOAD_USER_AVAILABILITY":return Object(E.a)({},e,{userAvailability:t.payload.reduce(function(e,t){return e[t.gig]=t,e},{})});case"LOAD_GIG_AVAILABILITY":return Object(E.a)({},e,{currentGigAvailability:t.payload.reduce(function(e,t){return e[t.member]=t,e},{})});case"SET_AUTH":return Object(E.a)({},e,{authenticated:t.payload});case"ADD_ERROR":return Object(E.a)({},e,{errors:[t.payload].concat(Object(y.a)(e.errors))});case"REMOVE_ERROR":return Object(E.a)({},e,{errors:Object(y.a)(e.errors.slice(1))});case"UPDATE_AVAILABILITY":var a=t.payload,n=e.currentGig,r=e.currentUser,i=Object(E.a)({},e);return a.gig===n._id&&(i.currentGigAvailability=Object(E.a)({},e.currentGigAvailability,Object(f.a)({},a.member,a))),a.member===r.memberId&&(i.userAvailability=Object(E.a)({},e.userAvailability,Object(f.a)({},a.gig,a))),i;case"GIG_UPDATED":var c=t.payload;c.date=new Date(c.date);var o=e.currentGig,l=e.gigsList,s=Object(E.a)({},e);return c._id===o._id&&(s.currentGig=Object(E.a)({},o,c)),s.gigsList=l.map(function(e){return e._id===c._id?Object(E.a)({},e,c):e}),s;case"UPDATE_DRAWER":return Object(E.a)({},e,{drawerOpen:t.payload});default:return e}}(e,t)},window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()),A=a(3),x=a(19),C=a(112),D=a.n(C),G=a(17),U=a(18),P=a.n(U),L=a(30),I=a(228),T=a.n(I),R=a(229),M=a.n(R),F=a(230),V=a.n(F),N=a(231),B=a.n(N),z=M()(),W=T()(null,{transports:["websocket"],forceNew:!0});z.configure(V()(W)),z.configure(B()({storage:window.localStorage}));var Y=function(e,t){for(var a=arguments.length,n=new Array(a>2?a-2:0),r=2;r<a;r++)n[r-2]=arguments[r];return new Promise(function(a,r){if(!["create","find","get","patch","update","remove","authenticate"].includes(e))return r("Invalid service method ".concat(e));W.emit.apply(W,[e,"api/".concat(t)].concat(n,[function(t,n){if(t)return console.error("EMIT ERROR",e,t),S.dispatch({type:"ADD_ERROR",payload:t}),r(t);a(n)}]))})},q=function(){var e=Object(L.a)(P.a.mark(function e(t){var a,n,r,i;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.email,n=t.password,r=t.project,e.next=3,z.authenticate({strategy:"local",email:a,password:n,project:r});case 3:return i=e.sent,e.abrupt("return",i);case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),H=function(){z.logout()},J=function(){var e=Object(L.a)(P.a.mark(function e(t){var a,n,r,i,c,o,l,s,u,m,p;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.accessToken,e.next=3,z.passport.verifyJWT(a);case 3:return n=e.sent,r=n.userId,i=n.projects,c=n.project,o=n.memberId,e.next=10,Y("find","members",{user:r,project:c});case 10:return l=e.sent[0].user,s=l.email,u=l.name,m=l.photo,p={userId:r,projects:Object.keys(i),name:u,email:s,photo:m,memberId:o,project:c},e.next=15,Promise.all([te(),ee(i),Z(c)]);case 15:S.dispatch(_.setAuth(!0)),S.dispatch(_.setUser(p));case 17:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();z.on("authenticated",J),z.on("logout",function(){S.dispatch(_.resetApp())});var X=z.service("api/members"),$=z.service("api/gigs"),K=z.service("api/gig-availability"),Q=z.service("api/projects"),Z=(z.service("api/registration"),function(e){return Y("get","projects",e).then(function(e){return S.dispatch(_.setProject(e))})}),ee=function(){var e=Object(L.a)(P.a.mark(function e(t){var a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y("find","projects",{_id:{$in:Object.keys(t)},$select:["name"]});case 2:return e.t0=function(e){return Object(E.a)({},e,{role:t[e._id]})},a=e.sent.map(e.t0),e.abrupt("return",S.dispatch(_.loadProjects(a)));case 5:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),te=function(){return Y("find","members",{$populate:"user"}).then(function(e){return S.dispatch(_.loadUsers(e))})},ae=function(e){S.dispatch(_.gigUpdated(e))};Q.on("patched",Z),X.on("created",te),X.on("patched",te),X.on("updated",te),X.on("removed",te),$.on("created",ae),$.on("patched",ae),$.on("updated",ae);var ne=function(e){S.dispatch(_.availabilityUpdated(e))};K.on("created",ne),K.on("patched",ne),K.on("updated",ne);var re=a(48),ie=a.n(re),ce=a(47),oe=a.n(ce),le=a(100),se=a.n(le),ue=a(156),me=a.n(ue),pe=a(155),de=a.n(pe),he=a(96),be=a.n(he),fe=a(97),ve=a.n(fe),ge=a(98),ye=a.n(ge),Ee=a(99),je=a.n(Ee),Oe=[{label:"Available",icon:r.a.createElement(be.a,{fontSize:"inherit",color:"primary"})},{label:"Unavailable",icon:r.a.createElement(ve.a,{fontSize:"inherit",color:"secondary"})},{label:"Maybe",icon:r.a.createElement(ye.a,{fontSize:"inherit",color:"action"})},{label:"Unknown",icon:r.a.createElement(je.a,{fontSize:"inherit"})}],we=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).updateAvailability=function(e,t){var n=e.target.value||t;if(n){var r=a.props,i=r.gigId,c=r.memberId,o=r.availability;c&&i&&(o?Y("patch","gig-availability",o._id,{member:c,gig:i,status:n}):Y("create","gig-availability",{member:c,gig:i,status:n}))}},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"interceptClick",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"render",value:function(){var e=this.props,t=e.buttons,a=void 0!==t&&t,n=e.availability,i=(n=void 0===n?{}:n).status,c=void 0===i?"Unknown":i;return a?r.a.createElement(de.a,{exclusive:!0,value:c,onChange:this.updateAvailability},Oe.map(function(e){return r.a.createElement(me.a,{key:e.label,value:e.label,style:{fontSize:24}},e.icon)})):r.a.createElement(oe.a,{onClick:this.interceptClick},r.a.createElement(ie.a,{value:c,onChange:this.updateAvailability},Oe.map(function(e){return r.a.createElement(se.a,{key:e.label,value:e.label},e.icon," ",e.label)})))}}]),t}(n.Component),ke=a(59),_e=a.n(ke),Se=a(101),Ae=a.n(Se),xe=a(75),Ce=a.n(xe),De=a(76),Ge=a.n(De),Ue=a(60),Pe=a(237),Le=(a(5684),Object(O.b)(function(e){return{users:e.users}})(function(e){var t,a,n,i=e.users||[];if(r.a.isValidElement(e))return r.a.createElement(A.i,{item:!0,xs:12,lg:6},e);var c=e.handleChange,o=e.handleBlur,l=e.props||{},s=l.onChange,u=l.onBlur,m=Object(Pe.a)(l,["onChange","onBlur"]);switch(e.type){case"Paragraph":m.multiline=!0,m.rows=m.rows||5,t=x.d;break;case"DateTime":m.type="datetime-local",t=x.d;break;case"Date":m.type="date",t=x.d;break;case"Member":n=e.label&&r.a.createElement(A.l,{shrink:!0},e.label),t=x.c,a=i.map(function(e){var t=e._id,a=e.name;return r.a.createElement(A.t,{key:t,value:t},a)});break;case"Time":m.type="time",t=x.d;break;case"Email":t=x.d,m.type="email";break;case"Text":t=x.d;break;case"Multiple choice":case"Radio":t=x.b,n=e.label&&r.a.createElement(A.l,{shrink:!0},e.label),a=e.options.map(function(e,t){return r.a.createElement(A.h,{key:t,value:e.value||e,control:r.a.createElement(A.u,null),label:e.label||e})});break;case"Checkboxes":t=x.a,m.Label={label:e.label};break;case"Link":t=x.d,m.type="url";break;case"Dropdown":case"Select":n=e.label&&r.a.createElement(A.l,{shrink:!0},e.label),t=x.c,a=e.options.map(function(e,t){return r.a.createElement(A.t,{key:t,value:e.value||e},e.label||e)});break;default:t=x.d}t===x.d&&(m.fullWidth=!0,m.InputLabelProps={shrink:!0});var p=r.a.createElement(G.a,Object.assign({name:e.name,label:e.label||e.name,component:t},m,{inputProps:{onChange:function(e){c(e),s&&s(e)},onBlur:function(e){o(e),u&&u(e)}}}),a);return r.a.createElement(A.i,{item:!0,xs:12,lg:6,className:"form-field"},n?r.a.createElement(A.g,{fullWidth:!0,className:"field-".concat(e.type)},n,p):p)})),Ie=(a(5707),function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).submit=function(){var e=Object(L.a)(P.a.mark(function e(t,n){var r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=a.props.onSubmit(t,n),e.next=4,Promise.resolve(r);case 4:e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.error("Form submit error",e.t0);case 9:n.setSubmitting(!1);case 10:case"end":return e.stop()}},e,null,[[0,6]])}));return function(t,a){return e.apply(this,arguments)}}(),a.handleChange=function(e,t,n){t(e),a.props.autoSubmit&&setTimeout(n)},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.initialValues,n=t.fields,i=t.submitLabel,c=t.buttons,o=void 0===c?[]:c;return r.a.createElement(G.d,{onSubmit:this.submit,initialValues:a,enableReinitialize:!0},function(t){t.handleSubmit;var a=t.handleChange,c=t.handleBlur,l=t.submitForm;t.values,t.errors;return r.a.createElement(G.c,{className:"giggity-form"},n.map(function(t,n){return r.a.createElement(Le,Object.assign({key:n,handleChange:function(t){e.handleChange(t,a,l)},handleBlur:c},t))}),i&&r.a.createElement("div",{className:"buttons"},r.a.createElement(A.b,{variant:"contained",color:"primary",type:"submit"},i),o.map(function(e,t){return r.a.createElement("span",{key:t},e)})))})}}]),t}(n.Component)),Te=function(e){return Ge()(e||new Date).format("YYYY-MM-DDTHH:mm")},Re={_id:null,tab:"details"},Me=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).changeTab=function(e,t){a.setState({tab:t})},a.state=Re,a.saveGig=a.saveGig.bind(Object(j.a)(Object(j.a)(a))),a.deleteGig=a.deleteGig.bind(Object(j.a)(Object(j.a)(a))),a.state.gigFilter="",a.dateFields=["start","end","load_in","event_start","event_end"],a.defaultGig={name:"",description:"",start:Te(),end:Te()},(a.props.currentProject.custom_fields||[]).map(function(e){Object(Ue.set)(a.defaultGig,"custom_fields.".concat(e.label),Object(Ue.get)(a.defaultGig,"custom_fields.".concat(e.label))||e.default||"")}),a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.updateGig()}},{key:"componentDidUpdate",value:function(e){var t=this.props.match.params.id;this.props.currentGig;t!==e.match.params.id&&(this.updateGig(),this.props.drawerOpen&&this.props.updateDrawer(!1))}},{key:"componentWillUnmount",value:function(){this.props.loadGig({}),this.props.loadGigAvailability([])}},{key:"updateGig",value:function(){var e=this,t=this.props.match.params.id;t?(Y("get","gigs",t).then(function(t){e.props.loadGig(t)}),Y("find","gig-availability",{gig:t}).then(function(t){e.props.loadGigAvailability(t.data)})):(this.setState(Re),this.props.loadGig(Re))}},{key:"saveGig",value:function(e){var t=this,a=this.props.match.params.id;return this.dateFields.forEach(function(t){e[t]=Ge()(e[t],"YYYY-MM-DDTHH:mm").toISOString()}),delete e._id,(a?Y("patch","gigs",a,e):Y("create","gigs",e)).then(function(e){a||t.props.history.push("/gigs/".concat(e._id))})}},{key:"deleteGig",value:function(){var e=this,t=this.props.match.params.id;return Y("remove","gigs",t).then(function(){e.props.history.push("/")})}},{key:"renderDetails",value:function(){var e=this.props,t=e.currentGig,a=e.currentProject,n=this.props.match.params.id,i=Object(Ue.merge)({},this.defaultGig,t);this.dateFields.forEach(function(e){i[e]=Te(t[e])});var c=(a.custom_fields||[]).map(function(e){return Object(Ue.set)(i,"custom_fields.".concat(e.label),Object(Ue.get)(i,"custom_fields.".concat(e.label))||e.default||""),Object(E.a)({},e,{name:"custom_fields.".concat(e.label)})}),o=[{type:"Text",label:"Name",name:"name"},{type:"DateTime",label:"Start Time",name:"start"},{type:"DateTime",label:"End Time",name:"end"},{type:"Paragraph",label:"Description",name:"description"}].concat(Object(y.a)(c)),l=r.a.createElement(A.b,{variant:"outlined",onClick:this.deleteGig},"Delete Gig");return r.a.createElement(Ie,{onSubmit:this.saveGig,initialValues:n?i:this.defaultGig,fields:o,buttons:[l],submitLabel:"Save Gig"})}},{key:"renderFilter",value:function(){return r.a.createElement(A.s,null,"Filter",r.a.createElement(A.r,{primary:r.a.createElement(_e.a,{name:"name-filter",value:this.state.nameFilter,label:"Name"})}),r.a.createElement(A.q,null,r.a.createElement(we,null)))}},{key:"renderAvailbility",value:function(){var e=this.props.match.params.id,t=this.props,a=t.users,n=t.currentGigAvailability;if(console.log(n),e)return r.a.createElement(A.n,{subheader:this.renderFilter()},a.map(function(t){return r.a.createElement(A.o,{divider:!0,key:t._id},r.a.createElement(A.r,{primary:t.name}),r.a.createElement(A.q,null,r.a.createElement(we,{buttons:!0,memberId:t._id,gigId:e,availability:n[t._id]})))}))}},{key:"render",value:function(){var e=this.props.match.params.id,t=this.props,a=t.currentGig,n=(t.currentProject,this.state.tab);return r.a.createElement("div",null,r.a.createElement(C.Helmet,null,r.a.createElement("title",null,"Giggity - ".concat(a.name))),e?r.a.createElement(A.x,{variant:"h4",gutterBottom:!0,align:"center"},a.name):null,r.a.createElement(Ae.a,{value:n,onChange:this.changeTab,variant:"fullWidth"},r.a.createElement(Ce.a,{value:"details",label:"Details"}),r.a.createElement(Ce.a,{value:"availability",label:"availability"})),r.a.createElement(A.i,{container:!0,justify:"center",alignItems:"center"},r.a.createElement(A.i,{item:!0,xs:12,lg:6},"details"===n&&this.renderDetails(),"availability"===n&&this.renderAvailbility())))}}]),t}(n.Component),Fe=Object(O.b)(function(e){return{users:(t=e).users,currentGig:t.currentGig,currentGigAvailability:t.currentGigAvailability,drawerOpen:t.drawerOpen,currentProject:t.currentProject};var t},{loadGig:_.loadGig,loadGigAvailability:_.loadGigAvailability,updateAvailability:_.updateAvailability,updateDrawer:_.updateDrawer})(Me),Ve={name:"",password:"",email:"",accessCode:"",id:null},Ne=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).updateUser=function(){var e=a.props.match.params.id;e?Y("get","users",e).then(function(e){return a.setState(e)}):a.setState(Ve)},a.saveUser=function(e){var t=a.props.match.params.id;return a.setState(Ve),delete e.id,(t?Y("patch","users",t,e):Y("create","users",e)).then(function(e){e._id!==a.props.match.params.id?a.props.history.push("members/".concat(e._id)):a.setState(e)})},a.deleteUser=function(){var e=a.props.match.params.id;return Y("remove","users",e).then(function(){a.props.history.push("/")})},a.state=Ve,a.saveUser=a.saveUser.bind(Object(j.a)(Object(j.a)(a))),a.deleteUser=a.deleteUser.bind(Object(j.a)(Object(j.a)(a))),a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.updateUser()}},{key:"componentDidUpdate",value:function(e){this.props.match.params.id!==e.match.params.id&&this.updateUser()}},{key:"render",value:function(){var e=this,t=this.state,a=t.name,n=t.accessCode;return r.a.createElement("div",null,r.a.createElement("h3",null,a),r.a.createElement("i",null,"Access code is ",n," "),r.a.createElement(G.d,{onSubmit:this.saveUser,initialValues:this.state,enableReinitialize:!0},function(t){t.handleSubmit,t.handleChange,t.handleBlur,t.values,t.errors;return r.a.createElement(G.c,null,r.a.createElement(G.a,{name:"name",label:"Name","data-validators":"isRequired",component:x.d}),r.a.createElement(G.a,{name:"email",label:"Email",type:"email","data-validators":"isRequired",component:x.d}),r.a.createElement(A.b,{variant:"contained",type:"submit",color:"primary"},"Save User"),r.a.createElement(A.b,{variant:"contained",onClick:e.deleteUser,color:"secondary"},"Delete User"))}))}}]),t}(n.Component),Be=Object(O.b)(function(e){return{users:e.users}})(Ne),ze=a(5747),We=a(29),Ye=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).renderGigItem=function(e){var t=a.props,n=t.currentGig,i=t.userAvailability,c=t.currentUser,o=t.classes,l=Ge()(e.start).format("MM/DD");return r.a.createElement(A.o,{button:!0,divider:!0,key:e._id,component:ze.a,selected:n._id===e._id,to:"/gigs/".concat(e._id),alignItems:"flex-start"},r.a.createElement(A.p,null,r.a.createElement("b",null,l)),r.a.createElement(A.r,{primaryTypographyProps:{className:o.title},secondaryTypographyProps:{component:"div"},primary:r.a.createElement(A.m,{component:"span"},e.name),secondary:r.a.createElement(we,{memberId:c.memberId,gigId:e._id,availability:i[e._id]})}))},a.updateData=a.updateData.bind(Object(j.a)(Object(j.a)(a))),a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){X.on("patched",this.updateData),$.on("created",this.updateData),$.on("removed",this.updateData),this.updateData()}},{key:"componentWillUnmount",value:function(){X.removeListener("patched",this.updateData),$.removeListener("created",this.updateData),$.removeListener("removed",this.updateData)}},{key:"updateData",value:function(){var e=this,t=this.props.currentUser;Y("find","gigs").then(function(t){return e.props.loadGigs(t.data)}),Y("find","gig-availability",{user:t.memberId}).then(function(t){return e.props.loadUserAvailability(t.data)})}},{key:"render",value:function(){var e=this.props,t=e.gigsList,a=e.currentGig;return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.o,{button:!0,component:ze.a,to:"/gigs/new",selected:null===a._id},r.a.createElement(A.r,{primary:"New Gig!"})),t.map(this.renderGigItem))}}]),t}(n.Component),qe=Object(O.b)(function(e){return{gigsList:(t=e).gigsList,currentGig:t.currentGig,currentUser:t.currentUser,userAvailability:t.userAvailability};var t},{loadGigs:_.loadGigs,loadUserAvailability:_.loadUserAvailability})(Object(We.withStyles)(function(e){return{title:{overflow:"hidden",textOverflow:"ellipsis"}}})(Ye)),He=a(236),Je=function(e){return r.a.createElement(A.m,Object.assign({component:ze.a},e))},Xe=[["Profile","profile"],["Communication","communication"],["Members","members"],["Custom Fields","custom_fields"]],$e=function(e){var t=e.currentLocation;return[r.a.createElement(A.s,{key:0},"Project Settings")].concat(Object(y.a)(Xe.map(function(e){var a=Object(He.a)(e,2),n=a[0],i=a[1];return r.a.createElement(A.o,{button:!0,key:n,component:Je,to:"/project/".concat(i),selected:Boolean(t.match(i))},r.a.createElement(A.r,{primary:n}))})))},Ke=(a(5719),Object(O.b)(function(e){return{drawerOpen:e.drawerOpen}})(function(e){var t=e.location,a=e.width,n=e.drawerWidth,i=e.drawerOpen;if(!e.showSidebar)return null;var c=t.pathname.split("/")[1];return r.a.createElement("nav",{className:"sidebar"},r.a.createElement(A.f,{anchor:"left",className:"gig-list",variant:"xs"===a?"temporary":"permanent",open:"xs"!==a||i,PaperProps:{style:{width:n}}},r.a.createElement(A.n,{style:{width:a}},"gigs"===c||""===c?r.a.createElement(qe,{currentLocation:t.pathname}):r.a.createElement($e,{currentLocation:t.pathname}))))})),Qe=a(232),Ze=a.n(Qe),et={email:"",accessCode:"",error:"",showLogin:!1},tt=function(e){function t(e){var a;Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).login=function(e,t){a.setState({error:""}),a.setState({accessCode:""}),q({email:e.email,password:e.accessCode,project:e.project}).then(function(){a.setState({authed:!0}),window.location="/auth/auth0"}).catch(function(e){a.setState({error:e.message})}).finally(function(){t.setSubmitting(!1)})},a.renderError=function(){if(a.state.error)return r.a.createElement("div",null,"Error: ",a.state.error)};var n=Ze.a.parse(a.props.location.search);return a.state=Object(E.a)({},et,n),n.accessCode&&(a.state.showLogin=!0),console.log(n),a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.email,n=t.accessCode;return t.showLogin?r.a.createElement("div",{style:{maxWidth:300,margin:"auto"}},r.a.createElement("h3",null,"Login"),this.renderError(),r.a.createElement(G.d,{onSubmit:this.login,initialValues:{email:a,accessCode:n},enableReinitialize:!0},function(t){t.handleSubmit,t.handleChange,t.handleBlur,t.values,t.errors;return r.a.createElement(G.c,null,r.a.createElement(G.a,{name:"email",label:"Email","data-validators":"isRequired",fullWidth:!0,component:x.d}),r.a.createElement(G.a,{name:"accessCode",label:"Access Code",type:"accessCode","data-validators":"isRequired",fullWidth:!0,component:x.d}),r.a.createElement(A.b,{variant:"contained",type:"submit",color:"primary"},"Login"),r.a.createElement(A.b,{color:"default",onClick:function(){return e.setState({showLogin:!1})}},"Cancel"))}),r.a.createElement(A.m,{href:"/auth/auth0"},"Sign in With Auth0")):r.a.createElement("div",{style:{textAlign:"center",display:"flex",flexDirection:"row",justifyContent:"space-around",maxWidth:"700px",margin:"auto",height:"400px",alignItems:"center"}},r.a.createElement(A.b,{size:"large",variant:"contained",color:"primary",href:"/auth/auth0"},"Login with Auth0"),r.a.createElement(A.b,{size:"large",variant:"contained",color:"default",onClick:function(){return e.setState({showLogin:!0})}},"Login with Access Code"))}}]),t}(n.Component),at=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.x,{variant:"h3",align:"center",gutterBottom:!0},"Welcome to Giggity!"),r.a.createElement(A.x,{variant:"body1",align:"center",gutterBottom:!0},"blah blah blah abut giggity..."),r.a.createElement(A.i,{direction:"row",justify:"space-evenly",alignItems:"center",spacing:40,container:!0},r.a.createElement(A.i,{item:!0,xs:6},r.a.createElement(A.c,{raised:!0},r.a.createElement(A.d,{component:ze.a,to:"/login"},r.a.createElement(A.e,{title:"Sign In",align:"center"})))),r.a.createElement(A.i,{item:!0,xs:6},r.a.createElement(A.c,{raised:!0},r.a.createElement(A.d,{component:ze.a,to:"/signup"},r.a.createElement(A.e,{title:"Sign Up",align:"center"}))))))},nt=a(102),rt=a.n(nt),it=a(72),ct=a.n(it),ot=a(103),lt=a.n(ot),st=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).handleClose=function(e,t){a.props.removeError()},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.classes;return t.errors.reverse().map(function(t,n){return r.a.createElement(rt.a,{key:n,className:a.error,anchorOrigin:{vertical:"bottom",horizontal:"center"},ContentProps:{classes:{root:a.error}},open:!0,onClose:e.handleClose,message:r.a.createElement("span",null,t.message||t),action:[r.a.createElement(ct.a,{key:"close","aria-label":"Close",color:"inherit",className:a.close,onClick:e.handleClose},r.a.createElement(lt.a,null))]})})}}]),t}(r.a.Component),ut=Object(We.withStyles)(function(e){return{error:{backgroundColor:e.palette.error.dark},close:{padding:e.spacing.unit/2}}})(st),mt=a(104),pt=a.n(mt),dt=a(105),ht=a.n(dt),bt=a(106),ft=a.n(bt),vt={email:"",name:"",password:"",project:"",error:"",activeStep:0,verificationCode:""},gt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).submit=function(){var e=Object(L.a)(P.a.mark(function e(t,n){var r,i,c,o,l,s,u,m,p,d,h,b;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.state.activeStep,e.prev=1,0!==r){e.next=11;break}return i=t.project,c=t.email,a.setState({project:i,email:c}),e.next=7,Y("create","registration",{project:i,email:c});case 7:o=e.sent,a.setState({verificationCode:o.verificationCode}),e.next=28;break;case 11:if(1!==r){e.next=20;break}return l=t.verificationCode,s=t.project,u=t.email,e.next=15,Y("patch","registration",null,{verified:!0},{verificationCode:l,email:u,project:s});case 15:return m=e.sent,e.next=18,q({email:u,password:l,project:m[0].project_id});case 18:e.next=28;break;case 20:if(2!==r){e.next=28;break}return p=t.email,d=t.name,h=t.password,e.next=24,Y("patch","users",a.props.currentUser.userId,{name:d,password:h});case 24:return b=e.sent,e.next=27,q({email:p,password:h,project:b.project});case 27:a.props.history.push("/");case 28:a.setState({activeStep:r+1}),e.next=33;break;case 31:e.prev=31,e.t0=e.catch(1);case 33:n.setSubmitting(!1);case 34:case"end":return e.stop()}},e,null,[[1,31]])}));return function(t,a){return e.apply(this,arguments)}}(),a.state=vt,a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=Object(L.a)(P.a.mark(function e(){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H();case 2:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"renderCreateForm",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(G.a,{name:"email",label:"Email","data-validators":"isRequired",fullWidth:!0,component:x.d}),r.a.createElement(G.a,{name:"project",label:"Project","data-validators":"isRequired",fullWidth:!0,component:x.d}))}},{key:"renderVerifyForm",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("i",null,"this will normally come via email: ",this.state.verificationCode),r.a.createElement(G.a,{name:"verificationCode",label:"Verification Code","data-validators":"isRequired",fullWidth:!0,component:x.d}))}},{key:"renderSetupForm",value:function(){return r.a.createElement("div",{style:{maxWidth:300,textAlign:"center",margin:"auto"}},r.a.createElement(A.x,{variant:"body1",gutterBottom:!0},"We use a service called Auth0 to manage our logins. Click below to set up Auth0. You can either link your Giggity account to a google account, or set up a login and password."),r.a.createElement(A.b,{color:"primary",variant:"contained",href:"/auth/auth0"},"Set up Auth0"))}},{key:"render",value:function(){var e=this,t=this.state.activeStep;return r.a.createElement(r.a.Fragment,null,r.a.createElement(A.x,{variant:"h5"},"Create a new Giggity Project"),r.a.createElement(pt.a,{activeStep:t},["Sign Up","Verify Email","Complete"].map(function(e){return r.a.createElement(ht.a,{key:e},r.a.createElement(ft.a,null,e))})),2===t?this.renderSetupForm():r.a.createElement(G.d,{onSubmit:this.submit,initialValues:this.state,enableReinitialize:!0},function(a){a.handleSubmit,a.handleChange,a.handleBlur,a.values,a.errors;return r.a.createElement(G.c,{autocomplete:"off"},0===t&&e.renderCreateForm(),1===t&&e.renderVerifyForm(),r.a.createElement(A.b,{variant:"contained",type:"submit",color:"primary"},"Next"))}))}}]),t}(n.Component),yt=Object(O.b)(function(e){return{currentUser:e.currentUser}})(gt),Et=a(38),jt={label:"",type:"Text",options:["obe","two"],default:"",private:!1},Ot=["Text","Paragraph","Link","Dropdown","Member","Checkboxes","Multiple choice","Date","Time"],wt=function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,i=new Array(n),c=0;c<n;c++)i[c]=arguments[c];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(i)))).saveProject=function(){var e=Object(L.a)(P.a.mark(function e(t,n){var r;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.props.currentProject,e.next=3,Y("patch","projects",r._id,Object(E.a)({},t,{custom_fields:t.custom_fields.map(function(e){return Object(E.a)({},e,{options:e.options.split(",").map(function(e){return e.trim()})})})}));case 3:n.setSubmitting(!1);case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),a.renderField=function(e,t,a){return r.a.createElement(A.o,{key:t,divider:!0},r.a.createElement(A.i,{container:!0,direction:"row",spacing:24},r.a.createElement(Le,{label:"Label",name:"custom_fields[".concat(t,"].label"),"data-validators":"isRequired"}),r.a.createElement(Le,{label:"Type",name:"custom_fields[".concat(t,"].type"),"data-validators":"isRequired",type:"Select",options:Ot}),["Dropdown","Multiple Choice"].includes(e.type)&&r.a.createElement(Le,{label:"Options",name:"custom_fields[".concat(t,"].options"),onChange:function(e){return console.log(e)}}),r.a.createElement(Le,{label:"Default Value",name:"custom_fields[".concat(t,"].default")}),r.a.createElement(Le,{name:"custom_fields[".concat(t,"].private"),label:"Private Field",type:"Checkboxes"}),r.a.createElement(A.k,{onClick:function(){return a.move(t,t-1)}},r.a.createElement(Et.d,{fontSize:"small"})),r.a.createElement(A.k,{onClick:function(){return a.move(t,t+1)}},r.a.createElement(Et.c,{fontSize:"small"})),r.a.createElement(A.k,{onClick:function(){return a.remove(t)}},r.a.createElement(Et.f,{fontSize:"small"}))))},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this,t=this.props.currentProject,a=Object(E.a)({},t,{custom_fields:t.custom_fields.map(function(e){return Object(E.a)({},e,{options:e.options.join(", ")})})});return r.a.createElement(r.a.Fragment,null,r.a.createElement(D.a,null,r.a.createElement("title",null,"Giggity - ".concat(t.name," Settings"))),r.a.createElement(G.d,{onSubmit:this.saveProject,initialValues:a,render:function(t){return r.a.createElement(G.c,null,r.a.createElement(A.b,{type:"submit"},"Save Settings"),r.a.createElement(A.x,{gutterBottom:!0,variant:"h5"},"Custom Fields"),r.a.createElement(G.b,{name:"custom_fields",render:function(a){return r.a.createElement(A.n,null,t.values.custom_fields.map(function(t,n){return e.renderField(t,n,a)}),r.a.createElement(A.b,{onClick:function(){return a.push(jt)}},"Add Field"))}}))}}))}}]),t}(n.Component),kt=Object(O.b)(function(e){return{currentProject:e.currentProject}})(wt),_t=Object(O.b)(function(e){return{currentProject:e.currentProject}})(function(e){var t=e.currentProject,a=t._id,n=t.name,i=function(){var e=Object(L.a)(P.a.mark(function e(t){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y("patch","projects",a,t);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(Ie,{initialValues:{name:n},onSubmit:i,fields:[{type:"Text",label:"Project Name",name:"name"}],submitLabel:"Save Project"})}),St=(a(5737),["Admin","Manager","Member","Read-Only"]),At={email:"",role:"Member"},xt=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).inviteMember=function(){var e=Object(L.a)(P.a.mark(function e(t){var a;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y("create","users",{email:t.email,name:t.email,role:t.role});case 2:a=e.sent,console.log(a);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.updateMember=function(){var e=Object(L.a)(P.a.mark(function e(t){return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("update",t),e.next=3,Y("patch","members",t._id,t);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.deleteMember=function(e){return Object(L.a)(P.a.mark(function t(){var a;return P.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Y("remove","members",e);case 2:a=t.sent,console.log(a);case 4:case"end":return t.stop()}},t)}))},a.state=At,a.userFields=[{type:"Text",name:"email",label:"Email"},{type:"Dropdown",name:"role",label:"Role",options:St}],a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"members"},r.a.createElement(A.x,{gutterBottom:!0,variant:"subtitle1"},"Members"),this.props.users.map(function(t){return r.a.createElement("div",{key:t._id,className:"member"},t.name,r.a.createElement(Ie,{initialValues:t,fields:[{type:"Dropdown",name:"role",options:St}],autoSubmit:!0,onSubmit:e.updateMember}),r.a.createElement(A.k,{color:"inherit",onClick:e.deleteMember(t._id)},r.a.createElement(Et.a,{fontSize:"small"})))}),r.a.createElement(A.x,{gutterBottom:!0,variant:"subtitle1"},"Invite Member"),r.a.createElement(Ie,{initialValues:this.state,fields:this.userFields,submitLabel:"Invite Member",onSubmit:this.inviteMember}))}}]),t}(n.Component),Ct=a(73),Dt=a.n(Ct),Gt=(a(5738),function(e){function t(){var e,a;Object(m.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(r)))).switchProject=function(){var e=Object(L.a)(P.a.mark(function e(t){var n;return P.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.value,e.next=3,Y("patch","users",a.props.currentUser.userId,{project:n});case 3:window.location.reload();case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),a.handleDrawerToggle=function(){a.props.updateDrawer(!a.props.drawerOpen)},a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"renderSwitchProject",value:function(){var e=this,t=this.props,a=t.currentUser.project,n=t.projects;return!n||n.length<=1?null:r.a.createElement(A.v,{style:{color:"#fff"},inputProps:{color:"inherit"},name:"project",value:a,onChange:function(t){return e.switchProject(t)}},n.map(function(e){var t=e.name,a=e._id;return r.a.createElement(A.t,{key:a,value:a},t)}))}},{key:"render",value:function(){var e=this.props.authenticated;return r.a.createElement(A.a,{position:"fixed",className:"navbar"},r.a.createElement(A.w,null,r.a.createElement(A.j,{smUp:!0},r.a.createElement(A.k,{color:"inherit","aria-label":"Open drawer",onClick:this.handleDrawerToggle},r.a.createElement(Et.e,null))),r.a.createElement(A.x,{variant:"h4",color:"inherit",noWrap:!0,style:{flexGrow:1}},r.a.createElement(Je,{color:"inherit",to:"/"},"Giggity"),r.a.createElement(Je,{color:"inherit",to:"/project"},r.a.createElement(A.k,{color:"inherit"},r.a.createElement(Et.g,null)))),e&&r.a.createElement(r.a.Fragment,null,this.renderSwitchProject(),r.a.createElement(Je,{color:"inherit",to:"/",onClick:function(){return H()}},"Logout",r.a.createElement(A.k,{color:"inherit",onClick:this.handleDrawerToggle},r.a.createElement(Et.b,null))))))}}]),t}(n.Component)),Ut={updateDrawer:_.updateDrawer},Pt=Object(O.b)(function(e){return{authenticated:e.authenticated,currentUser:e.currentUser,projects:e.projects,drawerOpen:e.drawerOpen}},Ut)(Gt),Lt=(a(5739),{initialized:!1}),It=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(d.a)(this,Object(h.a)(t).call(this,e))).state=Lt,a.public_routes=["/","/login","/signup"],a}return Object(b.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e=this;z.authenticate().then(J).catch(function(e){return z.logout(),Promise.reject(e)}).finally(function(){e.setState({initialized:!0})})}},{key:"componentDidUpdate",value:function(){this.checkAuth()}},{key:"checkAuth",value:function(){!this.state.initialized||this.props.authenticated||this.public_routes.includes(this.props.location.pathname)||(this.props.history.push("/"),H())}},{key:"render",value:function(){var e=this.props,t=e.classes,a=e.authenticated,n=e.location,i=e.width,c=e.users,o=e.errors,l=e.removeError;if(!this.state.initialized)return"...";var s=a&&("/"===n.pathname||n.pathname.match(/^\/(gigs|project)/));return r.a.createElement("div",{style:{display:"flex"}},r.a.createElement(Pt,null),r.a.createElement(Ke,{authenticated:a,location:n,width:i,drawerWidth:300,showSidebar:s}),r.a.createElement("main",{className:t.home,style:{marginLeft:s&&"xs"!==i?300:0}},r.a.createElement("div",{className:t.toolbar}),r.a.createElement(ut,{errors:o,removeError:l}),r.a.createElement(v.a,null,r.a.createElement(g.a,{exact:!0,path:"/login",component:tt}),r.a.createElement(g.a,{exact:!0,path:"/signup",component:yt}),r.a.createElement(g.a,{exact:!0,path:"/gigs/new",component:Fe}),r.a.createElement(g.a,{exact:!0,path:"/members/new",component:Be}),r.a.createElement(g.a,{path:"/gigs/:id",component:Fe}),r.a.createElement(g.a,{path:"/project/profile",component:_t}),r.a.createElement(g.a,{path:"/project/custom_fields",component:kt}),r.a.createElement(g.a,{exact:!0,path:"/project/members"},r.a.createElement(xt,{users:c})),r.a.createElement(g.a,{path:"/project/members/:id",component:Be}),r.a.createElement(g.a,{exact:!0,path:""},!s&&r.a.createElement(at,null)))))}}]),t}(r.a.Component),Tt={removeError:_.removeError},Rt=Object(O.b)(function(e){return{errors:e.errors,authenticated:e.authenticated,users:e.users}},Tt)(Object(We.withStyles)(function(e){return console.log(e)||{appBar:{zIndex:e.zIndex.modal-1},toolbar:e.mixins.toolbar,home:Object(f.a)({flexGrow:1,backgroundColor:e.palette.background.default,padding:3*e.spacing.unit,flex:"1 1 100%"},e.breakpoints.up("sm"),{marginLeft:300}),paper:{color:"#000"}}})(Dt()()(It))),Mt=a(107),Ft=a.n(Mt),Vt=a(233),Nt=a.n(Vt),Bt=a(154),zt=a.n(Bt),Wt=(a(5741),Object(We.createMuiTheme)({palette:{primary:{main:Nt.a[900]},secondary:{main:zt.a[700]},action:{}},typography:{useNextVariants:!0}})),Yt=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(Ft.a,null),r.a.createElement(We.MuiThemeProvider,{theme:Wt},r.a.createElement(u.a,null,r.a.createElement(l.a,{path:"/",component:Rt}))))},qt=a(5748);c.a.render(r.a.createElement(O.a,{store:S},r.a.createElement(qt.a,null,r.a.createElement(Yt,null))),document.getElementById("root"))}},[[5492,1,2]]]);
//# sourceMappingURL=main.84ddc86b.chunk.js.map